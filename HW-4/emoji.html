<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="By Ken Friis Larsen (kflarsen@diku.dk)" />
  <title>Who Doesnâ€™t Love Emoji ðŸ’–</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro|Source+Serif+Pro|Oswald|Source+Code+Pro" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
  body {
      margin-top: 1.0em;
      background-color: white;
  /*    font-family: 'Gentium Book Basic', sans-serif;
     font-size: 1.143em;
  */    font-size: 13pt;
      color: black;
      width: 90%;
      margin: 0 auto;
  }

  html {
    font-family: "Source Serif Pro", Georgia, "Times New Roman", serif;
  }

  h2, h3, h4, h5, h6 {
    font-family: "Oswald", Helvetica, Arial, sans-serif;
    font-weight: 400;
    color: #313131;
    letter-spacing: -.025rem;
  }

  code {
     font-family: "Source Code Pro", Menlo, monospace;
  /*   font-size: 1.136em;
      font-size: 13pt;;
  */   background-color: #F0F3F3;

  }

  pre {
     background-color: #F0F3F3;
     padding: 6px;
     word-wrap: break-word;
     white-space: pre-wrap;
     font-family: "Source Code Pro", Menlo, monospace;
     border: 1px solid silver;
  /*    font-size: 15pt;
  */}

  h1 {
      font-family: "Oswald", Helvetica, Arial, sans-serif;
  }

  h1.title {
      text-align: left;
      /*font-size: 3.8em;
      */color: black; margin-bottom: 3px;
  }
  h1 .small { font-size: 0.4em; }
  h1 a { text-decoration: none }
  h2 { font-size: 1.5em; color: black; }
  h2.author { font-size: 1em; text-align: center; color: black; }
  h3.date {  font-size: 1em; text-align: center; color: black; }
  a { color: black; }
  .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
  .download { float: right; }
  /* pre { background: #000; color: #fff; padding: 15px;} */
  hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
  .footer { text-align:center; padding-top:30px; font-style: italic; }
  table   { border-collapse: collapse }
  td { border: 1px solid black }
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Who Doesnâ€™t Love Emoji <span class="emoji" data-emoji="sparkling_heart">ðŸ’–</span></h1>
<p class="author">By Ken Friis Larsen <code>(kflarsen@diku.dk)</code></p>
<p class="date">Last revision: September 28, 2021</p>
</header>
<h1 id="part-1-warm-up">Part 1: Warm up</h1>
<p>The Haskell package <a href="https://hackage.haskell.org/package/async">async</a> provide a (monadic) library for running IO operations asynchronously and waiting for their results. Implement an Erlang module, <code>async</code>, to provide similar functionality. That is, you should implement the following minimal API, where <code>Aid</code> stands for an action ID, which is an opaque datatype (that is, you decide what it should be):</p>
<ul>
<li><p><code>new(Fun, Arg)</code> that starts a concurrent computation that computes <code>Fun(Arg)</code>. It returns an action ID.</p></li>
<li><p><code>poll(Aid)</code> that check whether an asynchronous action has completed yet. If it has not completed yet, then the result is <code>nothing</code>; otherwise the result is either <code>{exception, Ex}</code> if the asynchronous action raised the exception <code>Ex</code>, or <code>{ok, Res}</code> if it returned the value <code>Res</code>.</p></li>
<li><p><code>wait(Aid)</code> that waits for an asynchronous action to complete, and return the value of the computation. If the asynchronous action threw an exception, then the exception is re-thrown by <code>wait</code>.</p></li>
</ul>
<h1 id="part-2-emoji-server">Part 2: Emoji Server</h1>
<h2 id="objective">Objective</h2>
<p>The learning objectives of this assignment are:</p>
<ul>
<li><p>Gain hands-on programming experience with Erlang, how to structure modules and splitting code into functions.</p></li>
<li><p>Learn how to implement a simple server.</p></li>
<li><p>Dipping the toes into making robust code.</p></li>
</ul>
<p>The assignment is about making an <em>Emoji server</em> that allow looking up shortcodes for emoji.</p>
<h2 id="terminology">Terminology</h2>
<p><a href="https://en.wikipedia.org/wiki/Emoji">Emoji</a> (aka emoticons) are ideograms and smileys used in electronic messages and web pages.</p>
<p>An <em>emoji shortcode</em> is an ASCII string starting and ending with <code>:</code> (colon) that denotes an emoji. For instance, <code>:smiley:</code> denotes <span class="emoji" data-emoji="smiley">ðŸ˜ƒ</span>, and <code>:facepalm:</code> denotes <span class="emoji" data-emoji="facepalm">ðŸ¤¦</span>.</p>
<p>We represent emoji as binaries with the UTF-8 encoding of the emoji. For instance the binary <code>&lt;&lt;240,159,152,131&gt;&gt;</code> represents <span class="emoji" data-emoji="smiley">ðŸ˜ƒ</span> and <code>&lt;&lt;240,159,164,166&gt;&gt;</code> represents <span class="emoji" data-emoji="facepalm">ðŸ¤¦</span>.</p>
<p>An analytics function is a function that takes a shortcode and some state and returns an updated state. Analytics functions may raise exception and may fail to terminate. Your code should be robust against this. Robust here means that an emoji server should, ideally, continue to run and answer requests, even if an analytics function throws exceptions or takes a long (potentially infinite) time to terminate. (Note that it is unspecified how to deal with <strong>errors</strong>, thus if you do something special you should document that.)</p>
<p>Types:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode erlang"><code class="sourceCode erlang"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="ch">type</span> <span class="fu">shortcode()</span> <span class="fu">::</span> <span class="fu">string().</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="ch">type</span> <span class="fu">emoji()</span> <span class="fu">::</span> <span class="fu">binary().</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="ch">type</span> <span class="fu">analytic_fun(</span><span class="va">State</span><span class="fu">)</span> <span class="fu">::</span> <span class="kw">fun</span><span class="fu">((shortcode(),</span> <span class="va">State</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="va">State</span><span class="fu">).</span></span></code></pre></div>
<p>In this assignment we shall not be concerned with enforcing a specific form of shortcodes, such as starting and ending with <code>:</code>, this a job for a parser using our module. Any string will do. Likewise, itâ€™s out of scope to enforce that the binaries are valid UTF-8 encoded emoticons.</p>
<h2 id="the-emoji-module">The Emoji module</h2>
<p>Implement an Erlang module <code>emoji</code> with the following API, where <code>E</code> always stands for an Emoji server:</p>
<ul>
<li><p><code>start(Initial)</code> <span class="emoji" data-emoji="smile">ðŸ˜„</span> for starting an Emoji server, with the initial shortcodes definition given by <code>Initial</code>. The type of <code>Initial</code> should be a list of pairs, where the first component is a string and the second is a binary. All shortcodes in <code>Initial</code> should be unique, otherwise it is an error.</p>
<p>Returns <code>{ok, E}</code> on success, or <code>{error, Reason}</code> if some error occurred.</p></li>
<li><p><code>new_shortcode(E, Short, Emo)</code> <span class="emoji" data-emoji="smiley">ðŸ˜ƒ</span> for registering that the shortcode <code>Short</code> denotes the emoji <code>Emo</code>. It is an error to try to register the same shortcode more than once.</p>
<p>Returns <code>ok</code> on success or <code>{error, Reason}</code> if some error occurred.</p></li>
<li><p><code>alias(E, Short1, Short2)</code> <span class="emoji" data-emoji="raised_hands">ðŸ™Œ</span> for registering <code>Short2</code> as an alias for <code>Short1</code> . It is an error if <code>Short1</code> is not registered, or if <code>Short2</code> is already registered.</p>
<p>After this function succeeds <code>Short2</code> should be a valid shortcode in every sense.</p>
<p>Returns <code>ok</code> on success or <code>{error, Reason}</code> if some error occurred.</p></li>
<li><p><code>delete(E, Short)</code> <span class="emoji" data-emoji="boom">ðŸ’¥</span> removes any denotations for <code>Short</code>. This is a <em>non-blocking</em> function that should always succeed (thus the return value is unspecified). Should delete all aliases for <code>Short</code> as well.</p></li>
<li><p><code>lookup(E, Short)</code> <span class="emoji" data-emoji="eyes">ðŸ‘€</span> for looking up the emoji for <code>Short</code>.</p>
<p>Returns <code>{ok, Emo}</code> on success, or <code>no_emoji</code> if no shortcode (including aliases) are found.</p></li>
<li><p><code>analytics(E, Short, Fun, Label, Init)</code> <span class="emoji" data-emoji="chart_with_upwards_trend">ðŸ“ˆ</span> for registering an analytics function for <code>Short</code> (and aliases). Where <code>Fun</code> is an analytics function, <code>Init</code> is the initial state for <code>Fun</code> (thus <code>Init</code> could be anything), and <code>Label</code> is a string.</p>
<p>A shortcode can have multiple analytics functions registered, but each must have a unique label. Analytics functions are evaluated when a shortcode (including aliases) is looked up.</p>
<p>Returns <code>ok</code> on success or <code>{error, Reason}</code> if some error occurred.</p></li>
<li><p><code>get_analytics(E, Short)</code> <span class="emoji" data-emoji="chart_with_downwards_trend">ðŸ“‰</span> for getting the result of all analytics functions associated with a specific shortcode (including aliases).</p>
<p>Returns <code>{ok, Stat}</code> on success, where <code>Stat</code> is a list <code>[{string, any()}]</code> with the label and the (updated) state for each analytics function registered for <code>Short</code>; otherwise returns <code>{error, Reason}</code> if some error occurred.</p></li>
<li><p><code>remove_analytics(E, Short, Label)</code> <span class="emoji" data-emoji="hocho">ðŸ”ª</span> for removing the analytics function registered under <code>Label</code> for <code>Short</code> (including aliases). This is a non-blocking function.</p></li>
<li><p><code>stop(E)</code> :godmode: for stopping an emoji server, and all associated processes (if relevant). Any use of <code>E</code> after this function has been called is an error that is outside the scope of the library.</p>
<p>Returns <code>ok</code> once all processes associated with <code>E</code> has terminated; or <code>{error, Reason}</code> if some error occurred.</p></li>
</ul>
<h2 id="example-use-of-the-emoji-module">Example use of the <code>emoji</code> module</h2>
<p>The following example module shows how to use the <code>emoji</code> module:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode erlang"><code class="sourceCode erlang"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-module</span><span class="fu">(</span><span class="ch">love_emoji</span><span class="fu">).</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">-export</span><span class="fu">([</span><span class="ch">try_it</span><span class="op">/</span><span class="dv">0</span><span class="fu">]).</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hit(</span><span class="va">_</span><span class="fu">,</span> <span class="va">N</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="va">N</span><span class="op">+</span><span class="dv">1</span><span class="fu">.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">accessed(</span><span class="va">SC</span><span class="fu">,</span> <span class="va">TS</span><span class="fu">)</span> <span class="op">-&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="va">Now</span> <span class="op">=</span> <span class="fu">calendar:local_time(),</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">[{</span><span class="va">SC</span><span class="fu">,</span><span class="va">Now</span><span class="fu">}</span> <span class="fu">|</span> <span class="va">TS</span><span class="fu">].</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setup()</span> <span class="op">-&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span><span class="ch">ok</span><span class="fu">,</span> <span class="va">E</span><span class="fu">}</span> <span class="op">=</span> <span class="fu">emoji:start([]),</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:new_shortcode(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;smiley&quot;</span><span class="fu">,</span> <span class="op">&lt;&lt;</span><span class="dv">240</span><span class="fu">,</span><span class="dv">159</span><span class="fu">,</span><span class="dv">152</span><span class="fu">,</span><span class="dv">131</span><span class="op">&gt;&gt;</span><span class="fu">),</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:new_shortcode(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;poop&quot;</span><span class="fu">,</span> <span class="op">&lt;&lt;</span><span class="st">&quot;\xF0\x9F\x92\xA9&quot;</span><span class="op">&gt;&gt;</span><span class="fu">),</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:alias(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;poop&quot;</span><span class="fu">,</span> <span class="st">&quot;hankey&quot;</span><span class="fu">),</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:analytics(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;smiley&quot;</span><span class="fu">,</span> <span class="kw">fun</span><span class="fu">(</span><span class="va">_</span><span class="fu">,</span> <span class="va">N</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="va">N</span><span class="op">+</span><span class="dv">1</span> <span class="kw">end</span><span class="fu">,</span> <span class="st">&quot;Counter&quot;</span><span class="fu">,</span> <span class="dv">0</span><span class="fu">),</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:analytics(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;hankey&quot;</span><span class="fu">,</span> <span class="kw">fun</span> <span class="ch">hit</span><span class="op">/</span><span class="dv">2</span><span class="fu">,</span> <span class="st">&quot;Counter&quot;</span><span class="fu">,</span> <span class="dv">0</span><span class="fu">),</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:analytics(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;poop&quot;</span><span class="fu">,</span> <span class="kw">fun</span> <span class="ch">accessed</span><span class="op">/</span><span class="dv">2</span><span class="fu">,</span> <span class="st">&quot;Accessed&quot;</span><span class="fu">,</span> <span class="fu">[]),</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">E</span><span class="fu">.</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print_analytics(</span><span class="va">Stats</span><span class="fu">)</span> <span class="op">-&gt;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lists:foreach(</span><span class="kw">fun</span><span class="fu">({</span><span class="va">Lab</span><span class="fu">,</span> <span class="va">Res</span><span class="fu">})</span> <span class="op">-&gt;</span> <span class="fu">io:fwrite(</span><span class="st">&quot;  ~s: ~p~n&quot;</span><span class="fu">,</span> <span class="fu">[</span><span class="va">Lab</span><span class="fu">,</span> <span class="va">Res</span><span class="fu">])</span> <span class="kw">end</span><span class="fu">,</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                  <span class="va">Stats</span><span class="fu">).</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">try_it()</span> <span class="op">-&gt;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">E</span> <span class="op">=</span> <span class="fu">setup(),</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span><span class="ch">ok</span><span class="fu">,</span> <span class="va">Res</span><span class="fu">}</span> <span class="op">=</span> <span class="fu">emoji:lookup(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;hankey&quot;</span><span class="fu">),</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">io:fwrite(</span><span class="st">&quot;I looked for :hankey: and got a pile of ~ts~n&quot;</span><span class="fu">,</span> <span class="fu">[</span><span class="va">Res</span><span class="fu">]),</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span><span class="ch">ok</span><span class="fu">,</span> <span class="va">Stats</span><span class="fu">}</span> <span class="op">=</span> <span class="fu">emoji:get_analytics(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;poop&quot;</span><span class="fu">),</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">io:fwrite(</span><span class="st">&quot;Poppy statistics:~n&quot;</span><span class="fu">),</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print_analytics(</span><span class="va">Stats</span><span class="fu">),</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">io:fwrite(</span><span class="st">&quot;(Hopefully you got a 1 under &#39;Counter&#39;)~n&quot;</span><span class="fu">).</span></span></code></pre></div>
<h2 id="testing-emoji">Testing <code>emoji</code></h2>
<p>You tests should be in a module called <code>test_emoji</code> in the <code>tests</code> directory, this module should export at least one function, <code>test_all/0</code>.</p>
<p>To test the quality of your test-suite, we might run your tests against our special <code>emoji</code> module(s), and OnlineTA might not do any testing of your code unless it is minimally satisfied with your tests.</p>
<p>Note that since weâ€™ll run your tests against <em>our</em> <code>emoji</code> module, the tests that are performed from <code>test_all/0</code> shouldnâ€™t rely on things specific to <em>your</em> solution. Thus, if you have tests that are specific to your implementation, then you might want to export a <code>test_everything/0</code> function as well (that could call <code>test_all/0</code>).</p>
<p>The <code>code/part2/tests/someemoji.erl</code> module contain two functions that return a list of pairs, where the first component is a string and the second is a binary, that you can use for your testing.</p>
<h2 id="how-to-get-started">How to get started</h2>
<p>The two difficult parts of this assignment are how to deal with aliases and how to deal with analytics function. Thus, the recommended course of action, is to first get a minimal version working that doesnâ€™t include aliases nor analytics function. After that, to deal either aliases or analytics functions, but not both at the same time.</p>
<p>Somewhat counterintuitive, analytics functions can be easier to start with before trying to deal with aliases.</p>
<h2 id="trickiness-of-aliases">Trickiness of aliases</h2>
<p>Aliases can be hard to wrap your head around. Especially <code>delete/2</code> can be hard to get right. Thus, you might want to start by writing some tests to help you understand the issues.</p>
<p>For instance, when you delete a shortcode that has one or more aliases then all aliases should be deleted, you should never need to look at the binary/binaries. Observe, that there is a difference between</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode erlang"><code class="sourceCode erlang"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:new_shortcode(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;poop&quot;</span><span class="fu">,</span> <span class="op">&lt;&lt;</span><span class="st">&quot;\xF0\x9F\x92\xA9&quot;</span><span class="op">&gt;&gt;</span><span class="fu">),</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:alias(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;poop&quot;</span><span class="fu">,</span> <span class="st">&quot;hankey&quot;</span><span class="fu">)</span></span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode erlang"><code class="sourceCode erlang"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:new_shortcode(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;+1&quot;</span><span class="fu">,</span> <span class="op">&lt;&lt;</span><span class="dv">240</span><span class="fu">,</span><span class="dv">159</span><span class="fu">,</span><span class="dv">145</span><span class="fu">,</span><span class="dv">141</span><span class="op">&gt;&gt;</span><span class="fu">),</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ch">ok</span> <span class="op">=</span> <span class="fu">emoji:new_shortcode(</span><span class="va">E</span><span class="fu">,</span> <span class="st">&quot;thumbsup&quot;</span><span class="fu">,</span> <span class="op">&lt;&lt;</span><span class="dv">240</span><span class="fu">,</span><span class="dv">159</span><span class="fu">,</span><span class="dv">145</span><span class="fu">,</span><span class="dv">141</span><span class="op">&gt;&gt;</span><span class="fu">)</span></span></code></pre></div>
<p>In the first case you have an alias in the second you donâ€™t. In the first case, if you delete either <code>poop</code> or <code>hankey</code> both are gone. In the second case, if you delete <code>thumbsup</code> them you still have <code>+1</code> as a shortcode.</p>
<h2 id="hand-in-instructions">Hand-in Instructions</h2>
<p>You should hand in two things:</p>
<ol type="1">
<li><p>A short report, <code>report.pdf</code> (normally 1â€“3 pages, including figures), for the main (not warm-up) part only, explaining the main design of your code, and <strong>an assessment</strong> of your implementation, including what this assessment is based on. See the generic instructions regarding the report in previous assignments.</p>
<p>In this assignment, it is of particular interest that you discuss how you deal with unreliable analytics functions. You should shortly discuss what issues they cause and how you deal with them. You should also describe what state your server (and other relevant processes) maintain. Likewise, consider making a diagram of your processes. How do the processes interact, and how many (kinds) are there in the system?</p></li>
<li><p>A ZIP archive <code>code.zip</code>, mirroring the structure of the handout, containing your timesheet, source code and tests.</p>
<p>Your own tests should be separated in one or more test files that must be in the <code>tests</code> directory, so that OnlineTA can treat them right.</p></li>
</ol>
<p>Make sure that you adhere to the types of the API, and test that you do.</p>
<p>To keep your TA happy, follow these simple rules:</p>
<ol type="1">
<li>The Erlang compiler, with the parameter <code>-Wall</code>, should not yield any errors or warnings for your code.</li>
<li>You should comment your code properly, especially if you doubt its correctness, or if you think there is a more elegant way to write a certain piece of code. A good comment should explain your ideas and provide insight.</li>
<li>Adhere to the restrictions set in the assignment text, and make sure that you export all of the requested API (even if some functions only have a dummy implementation).</li>
<li>Describe clearly what parts of the assignment you have solved.</li>
</ol>
<hr />
<p>End of assignment text.</p>
</body>
</html>
